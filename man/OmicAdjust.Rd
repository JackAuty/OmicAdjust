% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/OmicAdjust_help.R, R/omic_adjust.R
\name{OmicAdjust}
\alias{OmicAdjust}
\alias{omic_adjust}
\title{OmicAdjust (aka \code{omic_adjust}): pragmatic p-value redistribution for exploration}
\usage{
omic_adjust(p, alpha = 0.05)

OmicAdjust(p, alpha = 0.05)
}
\arguments{
\item{p}{Numeric vector of unadjusted p-values in \link{0, 1}. \code{NA} allowed.}

\item{alpha}{Numeric scalar in (0, 1). Default 0.05.}
}
\value{
A list; use \verb{$p_rescaled} for the rescaled values. Diagnostics also returned:
\code{expected}, \code{sd}, \code{upper}, \code{observed}, \code{excess}.

A list; use \verb{$p_rescaled} for the rescaled values.
}
\description{
Run your standard test to get \strong{unadjusted} p-values, then rescale with
\code{OmicAdjust()} (or \code{omic_adjust()}). Intended for \strong{exploration only}; not FDR control.

Estimate expected false positives at \code{alpha}, then redistribute p-values so
the \code{excess} smallest lie in \verb{[0, alpha]} and the rest in \verb{[alpha, 1]}.
Exploratory only (no FDR control).
}
\examples{
set.seed(1)
expr <- matrix(rnorm(1000*6), 1000)
grp  <- factor(rep(c('A','B'), each = 3))
p    <- apply(expr, 1, function(y) t.test(y ~ grp)$p.value)
out  <- OmicAdjust(p)                # alias: omic_adjust(p)
hist(p,            breaks = 20)
hist(out$p_rescaled, breaks = 20)

## Typical data.frame use:
## df$p_OmicAdjust <- OmicAdjust(df$unadjustedPvalues)$p_rescaled

set.seed(1); p <- c(runif(900), runif(100, max = 0.01))
OmicAdjust(p)$p_rescaled
omic_adjust(p)$p_rescaled

}
